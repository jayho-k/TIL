# socar7

ì¤‘ì ì„ ë‘¬ì•¼ í•  ì 

- deep learning engineersê°€ ë‹¨ìˆœíˆ ìˆ«ìë§Œ ë°”ê¾¸ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì–´ë–¤ì‹ìœ¼ë¡œ ëª¨ë¸ì„ ë‹¤ë£¨ê³  ì„¤ê³„í•˜ëŠ”ì§€ì— ëŒ€í•´ ë°°ì›Œë³´ì



## 1. CNNëª¨ë¸

- imageNet Challengeì—ì„œ ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì¸ ëª¨ë¸ë“¤



### 1-1 AlexNet

- gpuë¥¼ ì‚¬ìš©
- ReLUì‚¬ìš©
- Data augmentationí™œìš©
- drop outë„ì…



Data Augmentation

![image-20220606154425299](socar7.assets/image-20220606154425299.png)

- ì‚¬ëŒì€ ì‰½ê²Œ ê°œë¼ëŠ” ê²ƒì„ íŒë³„í•  ìˆ˜ ìˆì§€ë§Œ í”½ì…€ê°’ì´ êµ‰ì¥íˆ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆê²Œ ëœë‹¤.
- ì¡°ì‹¬í•´ì•¼í•˜ëŠ” ë¶€ë¶„
  - 6ì„ íšŒì „ì‹œì¼œ 9ì²˜ëŸ¼ ë³´ì´ê²Œ ë§Œë“¤ê³  ì´ labelì„ 6ì´ë¼ê³  ì£¼ê²Œ ëœë‹¤ë©´ ì˜¤íˆë ¤ ì—­íš¨ê³¼ê°€ ë‚  ìˆ˜ ìˆë‹¤ ë”°ë¼ì„œ ì´ëŸ° ë¶€ë¶„ì— ëŒ€í•´ì„œëŠ” ì¡°ì‹¬í•´ ì£¼ì–´ì•¼í•œë‹¤.



### 1-2 VGGNet

- layer ì´ 19ê°œ
- 144M parameters
- CNNì„ ë§ì´ ìŒ“ìœ¼ë‹ˆê¹ ì„±ëŠ¥ì´ ì¢‹ì•„ì§
- Conv filter 3x3



Conv filter 3x3ë§Œ ì‚¬ìš©í•œ ì´ìœ ??

- ë§ì€ conv layerë¥¼ ìŒ“ì„ ë•Œ ì´ë“ì´ ìˆê¸° ë•Œë¬¸ì´ë‹¤
  - parameters ìˆ˜ ì¸¡ë©´ì—ì„œ ì´ë“
    - ![image-20220606155342017](socar7.assets/image-20220606155342017.png)
    - ìœ„ :
      -  3x3ì„ ë‘ë²ˆ í†µê³¼í•œ ëª¨ìŠµ
      - ë§ˆì§€ë§‰ í•œì¹¸ì— receptive fieldëŠ” 5x5ì§œë¦¬(ì²«ë²ˆì§¸ì— ë…¸ë‘ìƒ‰ ë¶€ë¶„ê¹Œì§€)ê°€ í•œì¹¸ìœ¼ë¡œ ì••ì¶•ë˜ì–´ ìˆìŒ
      - íŒŒë¼ë¯¸í„° ìˆ˜ : c x c x 3 x 3 x 2 => 18c^2
    - ì•„ë˜ : 
      - 5x5ë¥¼ í•œë²ˆ í†µê³¼í•œ ëª¨ìŠµ
      - ë§ˆì§€ë§‰ë„ ë˜‘ê°™ì´ 5x5ê°€ í•œì¹¸ìœ¼ë¡œ ì••ì¶•ë˜ì–´ ìˆìŒ
      - íŒŒë¼ë¯¸í„° ìˆ˜ : c x c x 5 x 5 x 2 => 25c^2
    - paremeter ìˆ˜ê°€ ë§ìœ¼ë©´??
      - overfittingì˜ ìœ„í—˜
      - ì—°ì‚° ì‹œê°„ ì¦ê°€
      - ì–´ì°¨í”¼ layersë¥¼ ë§ì´ ìŒ“ì„ ê²ƒì´ê¸° ë•Œë¬¸ì— 3x3ìœ¼ë¡œ ë§ì´ ìŒ“ì•„ì„œ ì—°ì‚°ì„ ì¤„ì´ê² ë‹¤ëŠ” ì „ëµ
  - activationì„ ë” ë§ì´ ë„£ì„ ìˆ˜ ìˆìŒ
    - nonlinarity activationëŠ” input-ouput mappingì—ì„œ í‘œí˜„ë ¥ì„ ë†’ì´ëŠ” ì—­í• ì„ í•˜ê²Œ ëœë‹¤.
    - ë”°ë¼ì„œ activationì„ ë” ë§ì´ ì¤Œìœ¼ë¡œì¨ í‘œí˜„ë ¥ì„ ëŠ˜ë¦¬ëŠ” ì—­í• ì„ í•  ìˆ˜ ìˆë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.
  - ê¸°ë³¸ì ìœ¼ë¡œ 3x3 conv, stride = 1, padding = 1
    - ì´ë ‡ê²Œ í•˜ë©´ layer í¬ê¸°ë¥¼ ë˜‘ê°™ì´ ë§ì¶œ ìˆ˜ ìˆìŒ
    - ê¸°ë³¸í˜•íƒœ



### 1-3 ResNet

ë¬´ì‘ì • conv layerë¥¼ ë§ì´ ìŒ“ëŠ”ë‹¤ê³  ì„±ëŠ¥ì´ í–¥ìƒë˜ì§€ ì•ŠìŒ

- skip connectionì´ìš©
- 152layers 1001layerê¹Œì§€ í™•ì¥

![image-20220606160750269](socar7.assets/image-20220606160750269.png)

- 20layer ì§œë¦¬ê°€ 50layerë³´ë‹¤ ì„±ëŠ¥ì´ ì¢‹ìŒ
  - ì´ìœ 
  - gradinent vanishing or explodingí˜„ìƒ ë•Œë¬¸
  - exploding : ê¸°ìš¸ê¸°ê°€ ë¹„ì •ìƒì ìœ¼ë¡œ ì»¤ì§ìœ¼ë¡œì¨ ë°œì‚°í•´ ë²„ë¦¬ëŠ” í˜„ìƒ

- layerë¥¼ ë§ì´ ìŒ“ìœ¼ë©´ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œë“¤ì´ì—ˆë‹¤ (vanishing or exploding)
  - ë°”ë¡œ ì´ì „ layerë“¤ë¡œ ë¶€í„°ë§Œ ì…ë ¥ê°’ì„ ë°›ê²Œ ëœë‹¤.
  - ì¢…ì†ì ì¸ layer ê°„ì˜ ì—°ê²°ì´ ë„ˆë¬´ ê¸¸ì–´ì§€ê²Œ ë˜ë©´ì„œ ë°œìƒí•˜ëŠ” ë¬¸ì œë“¤
  - ë”°ë¼ì„œ ì´ëŸ° ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ layerë“¤ ê°„ì˜ skip connectionì´ë¼ëŠ” ê²ƒì„ ë§Œë“¤ì—ˆë‹¤.



##### Residual Block

layerë“¤ì´ deepí•´ì§€ë©´ í•™ìŠµì´ ì˜ ì•ˆë˜ì—ˆë˜ ì´ìœ  => ì´ì „ layerë“¤ì—ê²Œì„œë§Œ ì…ë ¥ì„ ë°›ì•˜ì—ˆê¸° ë•Œë¬¸ì´ë‹¤. 

![image-20220606161921542](socar7.assets/image-20220606161921542.png)

-  ì¤‘ê°„ì— layerë¥¼ skipí•˜ê²Œ ëœë‹¤ (skip connection)

- í†µê³„í•™ : input ê°’ - ouputê°’ ==> residualì´ë¼ê³  í•œë‹¤. 

- H(x) = F(x) + x 
  - x : ì…ë ¥ê°’
  -  H(x) : ì¶œë ¥ê°’
  - H(x) - x = F(x) ==> residual
  - ì‹¤ì œë¡œ í•™ìŠµì‹œì¼œì•¼ í•  ë¶€ë¶„ = F(x)



ì–´ë–»ê²Œ í•™ìŠµì— ë„ì›€ì´ ë ê¹Œ?? = identity function

identity function : input outputì´ ê°™ì€ í•¨ìˆ˜ 

H(x) ê°’ì´ identity functionì´ì—ˆë‹¤?

- ì¦‰ ì…ë ¥ê°’ì´ xì´ê³  outputê°’ë„ xê°’ì´ë‹¤. ==> ê·¸ë ‡ê²Œ ë§Œë“¤ê¸° ìœ„í•´ì„ ?

- F(x)ë¥¼ 0ìœ¼ë¡œ ë§Œë“¤ì–´ë²„ë¦¬ê²Œ ëœë‹¤ë©´? ==> ëª©í‘œë¥¼ ë‹¬ì„±í•˜ê²Œ ëœë‹¤. 
- ì˜ë¯¸ : ì¦‰ skip connection => ì´ì „ layerì˜ ì˜í–¥ ì—†ì´ ê·¸ ì „ì— ê°’ì„ ê·¸ëŒ€ë¡œ ê°€ì ¸ì˜¬ ìˆ˜ ìˆë‹¤ë¼ëŠ” ëœ»ì´ë‹¤. (ê·¸ë¦¼ì€ ì§ê´€ì ì¸ ì´í•´ , ì‹: ì–´ë–»ê²Œ ì˜í–¥ì„ ì•ˆë°›ê²Œ í•˜ë„ë¡ ì‹ì„ êµ¬í˜„ í–ˆëŠ”ì§€)

![image-20220606164407189](socar7.assets/image-20220606164407189.png)

- ë‹¨ìˆœíˆ í•œë‹¨ê³„ ì „ë§Œ skipí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ë” ì „ì˜ layerë¥¼ skipí•  ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ë³´ì—¬ì¤€ ê·¸ë¦¼ì´ë‹¤.





##### bottlenet block

1x1convë¥¼ í™œìš©í•´ì„œ í•™ìŠµ parameterìˆ˜ì™€ ì—°ì‚°ëŸ‰ì„ ì¤„ì´ëŠ” êµ¬ì¡° (ì£¼ë¡œ Resnet 50ì´ìƒì˜ í° ëª¨ë¸ì—ì„œ ì‚¬ìš©)

**1x1convì˜ ì˜ë¯¸**

- spatialí•œ ì •ë³´ë¥¼ ìœ ì§€

- channelì˜ ê°œìˆ˜ë¥¼ ëŠ˜ë¦¬ê±°ë‚˜ ì¤„ì´ëŠ”ë°ì— ì‚¬ìš©í•˜ê²Œ ëœë‹¤. (ë°ì´í„° ì°¨ì› ì••ì¶•ê°™ì€ ëŠë‚Œ)



![image-20220606165037562](socar7.assets/image-20220606165037562.png)

1. 1x1ë¡œ 256-d => 64-dë¡œ ì°¨ì›ì„ ì¶•ì†Œ
2. 3x3 convë¥¼ ì§„í–‰í•¨
3. 1x1ë¡œ 64-d => 256-dë¡œ ì°¨ì› í™•ì¥

- ì˜ë¯¸
  - 3x3 convëŠ” ê³„ì‚°ëŸ‰ì´ ë§ìŒ => spatialí•œ ì •ë³´(í¬ê¸°, ê³µê°„)ëŠ” ì°¨ì›ì„ ì¶•ì†Œí•´ì„œ ì–»ìŒ
  - í•˜ì§€ë§Œ í‰ì†Œì—ëŠ” í° ì±„ë„ìˆ˜ë¥¼ ì´ìš©í•´ì„œ í‘œí˜„ë ¥ì„ ëŠ˜ë¦¬ê² ë‹¤ëŠ” ê²ƒ
    - ì±„ë„ìˆ˜ê°€ ë§ë‹¤? => ì°¨ì›ì´ í¬ë‹¤? => í‘œí˜„ë ¥ì´ í¬ë‹¤(ë‹¤ì–‘í•œ íŠ¹ì§•ê³¼ ì •ë³´ë¥¼ ê°€ì§€ê³  ìˆì„ ê²ƒì´ê¸° ë•Œë¬¸)

- parameter ìˆ˜ ë¹„êµ
  - 2Ã—(ğ‘Ã—ğ‘Ã—3Ã—3)=18c^2 (ì¼ë°˜ì )
  - (4ğ‘Ã—ğ‘Ã—1Ã—1)+(ğ‘Ã—ğ‘Ã—3Ã—3)+(ğ‘Ã—4ğ‘Ã—1Ã—1)=17c^2 (bottlenet ì‚¬ìš©)
  - parameter ìˆ˜ë„ ë” ë‚®ê²Œ ë‚˜ì˜¤ê²Œ ëœë‹¤



CNNì˜ ë°œì „ íŠ¹ì§•ë“¤

- ì–´ë–»ê²Œ ë” ë§ì€ layerë“¤ì„ ìŒ“ì•„ì„œ ì¸ê³µì‹ ê²½ë§ì˜ í˜ì„ ëŒì–´ë‚¼ê¹Œ?

  



## Object Detection

- pretrained ëœ CNNì„ backbone networkë¡œ ì£¼ë¡œ ì‚¬ìš©í•¨
  - teskì— finetuningì„ í•´ì„œ ì‚¬ìš©í•˜ê¸°ë„ í•¨ => tansfer learning



Faster RCNN

- Fast RCNN = 2.3ì´ˆ ì¤‘ì—ì„œ 2ê°€ selective searchë¼ëŠ” ì ì„ ì•Œê²Œ ë˜ì—ˆìŒ
- ë”°ë¼ì„œ 





## Autoencode, upsampling

#### Semantic Segmentation

- ëª¨ë“  pixelì— ëŒ€í•œ classification
- pixelê°œìˆ˜ ë§Œí¼ cnnëŒë¦¬ë©´ ë„ˆë¬´ ë¹„íš¨ìœ¨ì 
- ë”°ë¼ì„œ í•œë²ˆì— ì—¬ëŸ¬ pixelì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆìœ¼ë©´ ì¢‹ê² ìŒ 
  ==> encoder - decoder



#### encoder - decoder

![image-20220606181017340](socar7.assets/image-20220606181017340.png)

- encoder (cnnê°™ì´ íŠ¹ì§•ì„ ë½‘ì•„ë‚´ëŠ” ì—­í• )
  - : featureì˜ í¬ê¸°ë¥¼ ì¤„ì´ëŠ” ì—­í• 
  - ì…ë ¥ë°ì´í„°ì—ì„œ ì˜ë¯¸ìˆëŠ” featureë¥¼ ì¶”ì¶œí•˜ëŠ” ë„¤íŠ¸ì›Œí¬
- decoder
  - ì£¼ë¡œ featureì˜ í¬ê¸°ë¥¼ ëŠ˜ë¦¬ëŠ” ì—­í• 
  - featureë¡œë¶€í„° ì›í•˜ëŠ” ê²°ê³¼ ê°’ì„ ìƒì„±í•˜ëŠ” ë„¤íŠ¸ì›Œí¬
  - latent featureì„ ê°€ì§€ê³  ì´ë¯¸ì§€ í¬ê¸°ì˜ outputì„ ë§Œë“¤ì–´ ë²„ë¦°ë‹¤ë©´??
    - í•œë²ˆì— segmentationì„ ë§Œë“¤ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ? í•˜ëŠ” ì•„ì´ë””ì–´
- latent feature
  - encoderì— ì˜í•´ ì••ì¶•ëœ ì…ë ¥ ë°ì´í„°ì˜ feature



### Autoencoder

- ì…ì¶œë ¥ì´ ê°™ì€ êµ¬ì¡°ë¥¼ ê°€ì§„ ì¸ê³µ ì‹ ê²½ë§



Autoencoderì˜ í•™ìŠµ

- encoderì—ì„œ ì´ë¯¸ì§€ì˜ ì ì ˆí•œ featureë¥¼ ë½‘ì•„ëƒ„
- ê·¸ featureì—ì„œ ë‹¤ì‹œ ì›ë³¸ ì´ë¯¸ì§€ë¥¼ ë³µì›í•´ë‚¸ë‹¤.
- í•™ìŠµì‹œí‚¤ëŠ” labelì€ ë”°ë¡œ ì£¼ì–´ì§€ëŠ”ê²ƒì´ ì•„ë‹˜ 
  - ì…ë ¥ì´ë¯¸ì§€ ê·¸ ìì²´ë¥¼ íƒ€ê²Ÿìœ¼ë¡œ ì‚¬ìš©í•˜ê²Œ ëœë‹¤.
  - ouputì´ë¯¸ì§€ì™€ ì›ë³¸ì´ë¯¸ì§€ê°„ì˜ ì°¨ì´ë¥¼ loss functionì„ ì´ìš©í•´ì„œ í•™ìŠµì‹œí‚¤ê²Œ ë˜ëŠ” ê²ƒ



ì–´ë””ì— ì“°ì´ê²Œ ë ê¹Œ? (pcaì— ëŒ€í•´ ì•Œì•„ë³´ê¸°)

- labelì´ ì—†ì´ë„ ì…ë ¥ë°ì´í„° featureë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆìŒ
- featureì°¨ì› ì¶•ì†Œ - ì¤‘ìš”í•œ ì •ë³´ë§Œ ì‚´ë¦¬ê¸°



#### CNNì—ì„œ Decoderì˜ upsamplingí•˜ëŠ” ë°©ë²•

- spatialí•œ ì •ë³´ë„ í‚¤ì›Œì£¼ê³  channelê°’ë„ í‚¤ì›Œì£¼ì–´ì•¼í•œë‹¤.
- ë°©ë²•
  - í•™ìŠµ parameterê°€ ì—†ëŠ” ê²½ìš°
    - Bilinear interpolation
  - í•™ìŠµ parameterê°€ ìˆëŠ” ê²½ìš°
    - Trnsposed convolution(Deconvolution)



#### Bilinear interpolation

![image-20220606183027750](socar7.assets/image-20220606183027750.png)





#### Transposed Convolution

- ìœ„ ê¸°ë²•ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ spatialí•œ íŠ¹ì§•ì„ ìœ ì§€í•œë‹¤ëŠ” íŠ¹ì§•ì„ ê°€ì§€ê³  ìˆìŒ

- convolutioní•˜ëŠ” ê²ƒì„ ê±°ê¾¸ë¡œ í•˜ëŠ” ëŠë‚Œ
- ì •ë³´ë¥¼ í•˜ë‚˜ì˜ ì…€ë¡œ ì¶•ì†Œì‹œí‚¤ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ í•˜ë‚˜ì˜ ì…€ì„ ëŠ˜ë¦¬ëŠ” ê²ƒì„
- outputí¬ê¸° =(ğ‘‘ğ‘–ğ‘›âˆ’1)Ã—ğ‘ ğ‘¡ğ‘Ÿğ‘–ğ‘‘ğ‘’+1âˆ’2Ã—ğ‘ğ‘ğ‘‘+ğ‘‘ğ‘–ğ‘™ğ‘ğ‘¡ğ‘–ğ‘œğ‘›Ã—(ğ‘˜âˆ’1)
  - ğ‘‘ğ‘–ğ‘™ğ‘ğ‘¡ğ‘–ğ‘œğ‘›??

![image-20220606184336807](socar7.assets/image-20220606184336807.png)

![image-20220606184559982](socar7.assets/image-20220606184559982.png)





























